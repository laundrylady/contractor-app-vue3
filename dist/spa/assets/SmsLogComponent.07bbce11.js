import{A as N,i as h,r as c,B as Q,o as V,E as x,m as b,K as S,L as t,l,N as T,O as U,R as C,ai as _,U as p,q as k,n as M,y as L,Q as R}from"./index.7da93179.js";import{a as y,Q as q}from"./QTable.01150601.js";import{a as D}from"./axios.07c7c7d9.js";import{u as I}from"./debug.9f3fb657.js";import{o as v,l as z,f as E,r as K,s as O}from"./help.4068c5a1.js";const j=k("br",null,null,-1),A={class:"text-grey"},$={key:0},X=N({__name:"SmsLogComponent",props:{team_id:null,bulk:{type:Boolean},order_id:null,user_id:null},setup(B){const r=B,f=h("bus"),w=c(),g=c(!1),n=Q({keyword:null}),P=[{name:"created_at",label:"Sent",align:"left",field:"created_at",sortable:!0},{name:"sending_user_id",label:"Sent by",align:"left",field:"sending_user_id",sortable:!0},{name:"mobile",sortable:!0,label:"Mobile",field:"mobile",align:"left"},{name:"message",sortable:!0,label:"Message",field:"message",align:"left"},{name:"message_id",sortable:!0,label:"Message ID",field:"message_id",align:"left"}],a=c({page:1,rowsNumber:v(),rowsPerPage:v(),sortBy:"created_at",descending:!0}),m=(o=null)=>{let s,e,i,d;o&&o.pagination?(s=o.pagination.page,e=o.pagination.rowsPerPage,i=o.pagination.sortBy,d=o.pagination.descending):(s=a.value.page,e=a.value.rowsPerPage,i=a.value.sortBy,d=a.value.descending),g.value=!0,D.post(`/sms/datatable/${s}`,{sortBy:i,sort_order:d?"desc":"asc",skip:s,rowsPerPage:e,keyword:n.keyword,user_id:r.user_id,team_id:r.team_id,order_id:r.order_id,bulk:r.bulk}).then(u=>{w.value=u.data.rows,g.value=!1,O(e),a.value.rowsNumber=u.data.total,a.value.page=s,a.value.rowsPerPage=e,a.value.sortBy=i,a.value.descending=d}).catch(u=>{I(u)})};return V(()=>{m(),f.on("getSmsLog",()=>{m()})}),x(()=>{f.off("getSmsLog")}),(o,s)=>(b(),S(R,null,{default:t(()=>[l(q,{rows:w.value,columns:P,"row-key":"id",filter:n.keyword,loading:g.value,pagination:a.value,"onUpdate:pagination":s[1]||(s[1]=e=>a.value=e),onRequest:m,class:"no-shadow","rows-per-page-options":p(K)},{"top-left":t(()=>[l(T,{modelValue:n.keyword,"onUpdate:modelValue":s[0]||(s[0]=e=>n.keyword=e),debounce:500,placeholder:"Keyword"},{append:t(()=>[l(U,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-created_at":t(e=>[l(y,{props:e},{default:t(()=>[C(_(p(z)(e.row.created_at)),1),j,k("small",A,_(p(E)(e.row.created_at)),1)]),_:2},1032,["props"])]),"body-cell-sending_user_id":t(e=>[l(y,{props:e},{default:t(()=>[e.row.sendingUser?(b(),M("span",$,_(e.row.sendingUser.fullname),1)):L("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1}))}});export{X as _};
