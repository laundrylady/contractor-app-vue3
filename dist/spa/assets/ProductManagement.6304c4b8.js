import{A as J,r as _,B as L,i as z,o as A,E as j,m as f,K as w,L as n,l as a,R as B,ai as p,G as x,S as b,ag as Y,M as Z,q as r,U as i,N as c,b3 as I,y as O,ae as ee,Q as E,aj as le,n as ie,F as se,t as ue,O as N}from"./index.7da93179.js";import{a as de,Q as T}from"./QBreadcrumbs.96094532.js";import{Q as F}from"./QSpace.2d911a61.js";import{Q as me}from"./QHeader.9f36f572.js";import{Q as ce,a as S}from"./QTable.01150601.js";import{a as G,Q as W}from"./QItem.642560fa.js";import{Q as pe}from"./QList.709f4980.js";import{Q as ge}from"./QMenu.00781621.js";import{Q as ve}from"./QPage.e25f8b02.js";import{Q as fe,a as _e}from"./QLayout.bec178d3.js";import{C as U}from"./ClosePopup.42f5b568.js";import{a as k}from"./axios.07c7c7d9.js";import{Q as ae,a as te}from"./QToolbarTitle.8a26e038.js";import{Q as R}from"./QSelect.0342b451.js";import{Q as oe}from"./QUploader.f9ddc267.js";import{u as ne,r as u}from"./index.esm.0811bb15.js";import{u as C}from"./debug.9f3fb657.js";import{z as P,d as re,o as X,s as be,r as ye,c as Ve,a as we}from"./help.4068c5a1.js";import"./QResizeObserver.66f1c4a6.js";import"./QMarkupTable.f781861b.js";import"./QLinearProgress.6e390987.js";import"./use-fullscreen.62410448.js";import"./rtl.ba9e3bff.js";import"./format.3e32b8d9.js";import"./QCircularProgress.a2ed8130.js";const $e={class:"text-h6"},Pe={class:"text-h6 q-mt-lg"},ke={class:"row q-col-gutter-md"},Qe={class:"col-xs-12 col-sm-4"},xe={class:"col-xs-12 col-sm-4"},Ue={class:"col-xs-12 col-sm-2"},Ce={class:"col-xs-12 col-sm-2"},qe=r("div",{class:"text-h6 q-mb-sm q-mt-lg"},"Image",-1),he={class:"row q-col-gutter-md"},Ne={class:"col-xs-12 col-sm-6"},Se=J({__name:"ProductCreate",setup(H){const d=_(!1),$={name:null,description:null,active:!0,tax:!0,unit_cost:null,unit_price:null,unit_minimum:null,unit_measurement:null,product_category_id:null,image:null},t=L(JSON.parse(JSON.stringify($))),y=_(!1),g=_(),V=z("bus"),s=ne({product_category_id:{required:u},name:{required:u},active:{required:u},tax:{required:u},unit_cost:{required:u},unit_minimum:{required:u},unit_price:{required:u},unit_measurement:{required:u}},t),q=o=>{t.image=o.xhr.response},h=()=>{t.image=null},Q=()=>{k.post("/product",t).then(()=>{re("positive","Product created"),V.emit("productLoadMore"),Object.assign(t,JSON.parse(JSON.stringify($))),d.value=!1,y.value=!1}).catch(o=>{C(o)})};return A(()=>{V.on("newProduct",()=>{d.value=!0,k.get("/productcategory/index").then(o=>{g.value=o.data.map(l=>({value:l.id,label:l.name}))}).catch(o=>{C(o)})})}),j(()=>{V.off("newProduct")}),(o,l)=>(f(),w(le,{modelValue:d.value,"onUpdate:modelValue":l[11]||(l[11]=e=>d.value=e)},{default:n(()=>[a(E,{class:"modal"},{default:n(()=>[a(ae,null,{default:n(()=>[a(te,null,{default:n(()=>[B("New "+p(o.$t("product.name")),1)]),_:1}),a(F),x(a(b,{icon:"close",flat:"",round:"",dense:""},null,512),[[U]])]),_:1}),a(Y),a(Z,null,{default:n(()=>[r("div",$e,p(o.$t("product.name"))+" "+p(o.$t("details")),1),a(R,{modelValue:t.product_category_id,"onUpdate:modelValue":l[0]||(l[0]=e=>t.product_category_id=e),label:"Category",error:i(s).product_category_id.$invalid,options:g.value,"emit-value":"","map-options":""},null,8,["modelValue","error","options"]),a(c,{modelValue:t.name,"onUpdate:modelValue":l[1]||(l[1]=e=>t.name=e),label:"Name",error:i(s).name.$invalid},null,8,["modelValue","error"]),a(c,{modelValue:t.description,"onUpdate:modelValue":l[2]||(l[2]=e=>t.description=e),label:"Description",autogrow:""},null,8,["modelValue"]),r("div",Pe,p(o.$t("pricing")),1),r("div",ke,[r("div",Qe,[a(c,{modelValue:t.unit_cost,"onUpdate:modelValue":l[3]||(l[3]=e=>t.unit_cost=e),label:"Unit Cost",error:i(s).unit_cost.$invalid,type:"number"},null,8,["modelValue","error"])]),r("div",xe,[a(c,{modelValue:t.unit_price,"onUpdate:modelValue":l[4]||(l[4]=e=>t.unit_price=e),label:"Unit Price",error:i(s).unit_price.$invalid,type:"number"},null,8,["modelValue","error"])]),r("div",Ue,[a(R,{modelValue:t.unit_measurement,"onUpdate:modelValue":l[5]||(l[5]=e=>t.unit_measurement=e),label:"Per",error:i(s).unit_measurement.$invalid,options:["5kg load","item"]},null,8,["modelValue","error"])]),r("div",Ce,[a(c,{modelValue:t.unit_minimum,"onUpdate:modelValue":l[6]||(l[6]=e=>t.unit_minimum=e),label:"Minimum",error:i(s).unit_minimum.$invalid,type:"number"},null,8,["modelValue","error"])])]),r("div",null,[a(I,{modelValue:t.tax,"onUpdate:modelValue":l[7]||(l[7]=e=>t.tax=e),label:"Taxable product"},null,8,["modelValue"])]),r("div",null,[a(I,{modelValue:t.active,"onUpdate:modelValue":l[8]||(l[8]=e=>t.active=e),label:"Product is active"},null,8,["modelValue"])]),qe,r("div",he,[r("div",Ne,[a(oe,{color:"grey-7",url:i(P).url,headers:i(P).headers,onUploaded:q,label:"Upload a new image","auto-expand":"","auto-upload":"",accept:i(P).images,ref:"avatarUpload","field-name":i(P).fieldName},null,8,["url","headers","accept","field-name"]),t.image?(f(),w(b,{key:0,onClick:l[9]||(l[9]=e=>h()),label:"Reset",class:"q-mt-md",color:"secondary"})):O("",!0)])])]),_:1}),a(ee,{align:"right"},{default:n(()=>[x(a(b,{label:"Cancel",flat:"",color:"secondary"},null,512),[[U]]),a(b,{disable:y.value||i(s).$invalid,label:"Save",color:"primary",onClick:l[10]||(l[10]=e=>Q())},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Be={class:"text-h6"},Oe={class:"text-h6 q-mt-lg"},Me={class:"row q-col-gutter-md"},De={class:"col-xs-12 col-sm-4"},Ie={class:"col-xs-12 col-sm-4"},Re={class:"col-xs-12 col-sm-2"},Te={class:"col-xs-12 col-sm-2"},Je=r("div",{class:"text-h6 q-mt-lg q-mb-sm"},"Image",-1),Le={class:"row q-col-gutter-md"},ze={class:"col-xs-12 col-sm-6"},Ae=J({__name:"ProductEdit",setup(H){const d=_(!1),$={id:null,name:null,description:null,active:!0,tax:!0,unit_cost:null,unit_price:null,unit_minimum:null,unit_measurement:null,product_category_id:null},t=L(JSON.parse(JSON.stringify($))),y=_(!1),g=_(),V=z("bus"),s=ne({product_category_id:{required:u},name:{required:u},active:{required:u},tax:{required:u},unit_cost:{required:u},unit_minimum:{required:u},unit_price:{required:u},unit_measurement:{required:u}},t),q=o=>{t.image=o.xhr.response},h=()=>{t.image=null},Q=()=>{k.put(`/product/${t.id}`,t).then(()=>{re("positive","Saved"),V.emit("productLoadMore"),Object.assign(t,JSON.parse(JSON.stringify($))),d.value=!1,y.value=!1}).catch(o=>{C(o)})};return A(()=>{V.on("editProduct",o=>{k.get(`/product/${o}`).then(l=>{Object.assign(t,l.data),d.value=!0,k.get("/productcategory/index").then(e=>{g.value=e.data.map(v=>({value:v.id,label:v.name}))}).catch(e=>{C(e)})})})}),j(()=>{V.off("newProduct")}),(o,l)=>(f(),w(le,{modelValue:d.value,"onUpdate:modelValue":l[11]||(l[11]=e=>d.value=e)},{default:n(()=>[a(E,{class:"modal"},{default:n(()=>[a(ae,null,{default:n(()=>[a(te,null,{default:n(()=>[B(p(t.name),1)]),_:1}),a(F),x(a(b,{icon:"close",flat:"",round:"",dense:""},null,512),[[U]])]),_:1}),a(Y),a(Z,null,{default:n(()=>[r("div",Be,p(o.$t("product.name"))+" "+p(o.$t("details")),1),a(R,{modelValue:t.product_category_id,"onUpdate:modelValue":l[0]||(l[0]=e=>t.product_category_id=e),label:"Category",error:i(s).product_category_id.$invalid,options:g.value,"emit-value":"","map-options":""},null,8,["modelValue","error","options"]),a(c,{modelValue:t.name,"onUpdate:modelValue":l[1]||(l[1]=e=>t.name=e),label:"Name",error:i(s).name.$invalid},null,8,["modelValue","error"]),a(c,{modelValue:t.description,"onUpdate:modelValue":l[2]||(l[2]=e=>t.description=e),label:"Description",autogrow:""},null,8,["modelValue"]),r("div",Oe,p(o.$t("pricing")),1),r("div",Me,[r("div",De,[a(c,{modelValue:t.unit_cost,"onUpdate:modelValue":l[3]||(l[3]=e=>t.unit_cost=e),label:"Unit Cost",error:i(s).unit_cost.$invalid,type:"number"},null,8,["modelValue","error"])]),r("div",Ie,[a(c,{modelValue:t.unit_price,"onUpdate:modelValue":l[4]||(l[4]=e=>t.unit_price=e),label:"Unit Price",error:i(s).unit_price.$invalid,type:"number"},null,8,["modelValue","error"])]),r("div",Re,[a(R,{modelValue:t.unit_measurement,"onUpdate:modelValue":l[5]||(l[5]=e=>t.unit_measurement=e),label:"Per",error:i(s).unit_measurement.$invalid,options:["5kg load","item"]},null,8,["modelValue","error"])]),r("div",Te,[a(c,{modelValue:t.unit_minimum,"onUpdate:modelValue":l[6]||(l[6]=e=>t.unit_minimum=e),label:"Minimum",error:i(s).unit_minimum.$invalid,type:"number"},null,8,["modelValue","error"])])]),r("div",null,[a(I,{modelValue:t.tax,"onUpdate:modelValue":l[7]||(l[7]=e=>t.tax=e),label:"Taxable product"},null,8,["modelValue"])]),r("div",null,[a(I,{modelValue:t.active,"onUpdate:modelValue":l[8]||(l[8]=e=>t.active=e),label:"Product is active"},null,8,["modelValue"])]),Je,r("div",Le,[r("div",ze,[a(oe,{color:"grey-7",url:i(P).url,headers:i(P).headers,onUploaded:q,label:"Upload a new image","auto-expand":"","auto-upload":"",accept:i(P).images,ref:"avatarUpload","field-name":i(P).fieldName},null,8,["url","headers","accept","field-name"]),t.image?(f(),w(b,{key:0,onClick:l[9]||(l[9]=e=>h()),label:"Reset",class:"q-mt-md",color:"secondary"})):O("",!0)])])]),_:1}),a(ee,{align:"right"},{default:n(()=>[x(a(b,{label:"Cancel",flat:"",color:"secondary"},null,512),[[U]]),a(b,{disable:y.value||i(s).$invalid,label:"Save",color:"primary",onClick:l[10]||(l[10]=e=>Q())},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),je={class:"q-pl-md q-pt-sm q-pr-md q-pb-sm flex items-center",style:{"padding-top":"11px"}},Ee=["onClick"],_l=J({__name:"ProductManagement",setup(H){const d=z("bus"),$=_(),t=_(null),y=_(!1),g=L({keyword:null}),V=[{name:"product_category_id",label:"Category",align:"left",field:"product_category_id",sortable:!0,style:"width:100px"},{name:"name",label:"Name",align:"left",field:"name",sortable:!0},{name:"unit_price",label:"Price",align:"left",field:"unit_price",sortable:!0},{name:"active",label:"Active",align:"left",field:"active",sortable:!0},{label:"Actions",name:"actions",sortable:!1,field:"actions"}],m=_({page:1,rowsNumber:X(),rowsPerPage:X(),sortBy:"name",descending:!1}),s=(o=null)=>{let l,e,v,M;o&&o.pagination?(l=o.pagination.page,e=o.pagination.rowsPerPage,v=o.pagination.sortBy,M=o.pagination.descending):(l=m.value.page,e=m.value.rowsPerPage,v=m.value.sortBy,M=m.value.descending),y.value=!0,k.post(`/product/datatable/${l}`,{sortBy:v,sort_order:M?"desc":"asc",skip:l,rowsPerPage:e,keyword:g.keyword}).then(D=>{var K;$.value=D.data.rows,y.value=!1,be(e),m.value.rowsNumber=D.data.total,m.value.page=l,m.value.rowsPerPage=e,m.value.sortBy=v,m.value.descending=M,o&&((K=t.value)==null||K.scrollIntoView({behavior:"smooth",block:"center"}))}).catch(D=>{C(D)})},q=o=>{we("This will remove the product").onOk(()=>{k.delete(`/product/${o}`).then(()=>{s()}).catch(l=>{C(l)})})},h=()=>{d.emit("newProduct")},Q=o=>{d.emit("editProduct",o)};return A(()=>{d.on("productLoadMore",()=>{s()}),s()}),j(()=>{d.off("productLoadMore")}),(o,l)=>(f(),ie(se,null,[a(Se),a(Ae),a(fe,{view:"lHh LpR fFf",container:"",class:"layout-height"},{default:n(()=>[a(me,{class:ue({"page-title text-black":!o.$q.dark.isActive,"bg-dark":o.$q.dark.isActive}),bordered:""},{default:n(()=>[r("div",je,[a(de,{class:"q-mb-md q-mt-md"},{separator:n(()=>[a(N,{size:"1.5em",name:"chevron_right"})]),default:n(()=>[a(T,{label:"Home",icon:"home",to:{name:"appDashboard"}}),a(T,{label:"Settings",to:{name:"settings"}}),a(T,{label:o.$t("product.namePlural")},null,8,["label"])]),_:1}),a(c,{modelValue:g.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>g.keyword=e),debounce:500,placeholder:"Keyword search",dense:"",borderless:"",class:"q-ml-lg",clearable:""},{prepend:n(()=>[a(N,{name:"search"})]),_:1},8,["modelValue"]),a(F),a(b,{onClick:l[1]||(l[1]=e=>h()),icon:"add",labe:"New Product",color:"primary",round:""})])]),_:1},8,["class"]),a(_e,null,{default:n(()=>[a(ve,{padding:""},{default:n(()=>[a(E,null,{default:n(()=>[r("div",{ref_key:"topRef",ref:t},null,512),a(ce,{rows:$.value,columns:V,"row-key":"id",filter:g.keyword,loading:y.value,pagination:m.value,"onUpdate:pagination":l[2]||(l[2]=e=>m.value=e),onRequest:s,class:"no-shadow","rows-per-page-options":i(ye)},{"body-cell-product_category_id":n(e=>[a(S,{props:e},{default:n(()=>[e.row.productcategory?(f(),w(N,{key:0,name:e.row.productcategory.icon,size:"32px"},null,8,["name"])):O("",!0)]),_:2},1032,["props"])]),"body-cell-name":n(e=>[a(S,{props:e},{default:n(()=>[e.row.icon?(f(),w(N,{key:0,name:e.row.icon,size:"32px",class:"q-mr-xs"},null,8,["name"])):O("",!0),r("a",{onClick:v=>Q(e.row.id),class:"link"},p(e.row.name),9,Ee)]),_:2},1032,["props"])]),"body-cell-unit_price":n(e=>[a(S,{props:e},{default:n(()=>[B(p(i(Ve)(e.row.unit_price))+" per "+p(e.row.unit_measurement),1)]),_:2},1032,["props"])]),"body-cell-active":n(e=>[a(S,{props:e},{default:n(()=>[e.row.active?(f(),w(N,{key:0,name:"check",color:"positive",size:"24px"})):O("",!0)]),_:2},1032,["props"])]),"body-cell-actions":n(e=>[a(S,{props:e},{default:n(()=>[a(b,{flat:"",icon:"more_vert"},{default:n(()=>[a(ge,null,{default:n(()=>[a(pe,null,{default:n(()=>[x((f(),w(W,{clickable:"",onClick:v=>Q(e.row.id)},{default:n(()=>[a(G,null,{default:n(()=>[B("Edit record")]),_:1})]),_:2},1032,["onClick"])),[[U]]),x((f(),w(W,{clickable:"",onClick:v=>q(e.row.id)},{default:n(()=>[a(G,null,{default:n(()=>[B("Delete")]),_:1})]),_:2},1032,["onClick"])),[[U]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1})]),_:1})]),_:1})]),_:1})],64))}});export{_l as default};
