import{A as Q,r as m,B as N,o as S,m as w,K as V,L as o,l as s,O as v,U as g,N as x,R as M,ai as c,q as p,n as T,y as q,Q as R}from"./index.7da93179.js";import{Q as y,a as U}from"./QBreadcrumbs.96094532.js";import{Q as C,a as P}from"./QTable.01150601.js";import{Q as D}from"./QPage.e25f8b02.js";import{a as I}from"./axios.07c7c7d9.js";import{u as L}from"./debug.9f3fb657.js";import{o as h,s as z,r as E,l as K,f as O}from"./help.4068c5a1.js";import"./QList.709f4980.js";import"./QMarkupTable.f781861b.js";import"./QSelect.0342b451.js";import"./QItem.642560fa.js";import"./rtl.ba9e3bff.js";import"./QMenu.00781621.js";import"./format.3e32b8d9.js";import"./QLinearProgress.6e390987.js";import"./use-fullscreen.62410448.js";const A=p("div",{class:"text-h4 q-mb-md"}," SMS Log ",-1),H=p("br",null,null,-1),$={class:"text-grey"},j={key:0},me=Q({__name:"SmsLog",setup(F){const f=m(),k=m(null),u=m(!1),l=N({keyword:null,type:"contractor",status:"active",role:"contractor"}),B=[{name:"created_at",label:"Sent",align:"left",field:"created_at",sortable:!0},{name:"sending_user_id",label:"Sent by",align:"left",field:"sending_user_id",sortable:!0},{name:"mobile",sortable:!0,label:"Mobile",field:"mobile",align:"left"},{name:"message",sortable:!0,label:"Message",field:"message",align:"left"},{name:"message_id",sortable:!0,label:"Message ID",field:"message_id",align:"left"}],a=m({page:1,rowsNumber:h(),rowsPerPage:h(),sortBy:"created_at",descending:!1}),_=(r=null)=>{let t,e,n,i;r&&r.pagination?(t=r.pagination.page,e=r.pagination.rowsPerPage,n=r.pagination.sortBy,i=r.pagination.descending):(t=a.value.page,e=a.value.rowsPerPage,n=a.value.sortBy,i=a.value.descending),u.value=!0,I.post(`/sms/datatable/${t}`,{sortBy:n,sort_order:i?"desc":"asc",skip:t,rowsPerPage:e,keyword:l.keyword}).then(d=>{var b;f.value=d.data.rows,u.value=!1,z(e),a.value.rowsNumber=d.data.total,a.value.page=t,a.value.rowsPerPage=e,a.value.sortBy=n,a.value.descending=i,r&&((b=k.value)==null||b.scrollIntoView({behavior:"smooth",block:"center"}))}).catch(d=>{L(d)})};return S(()=>{_()}),(r,t)=>(w(),V(D,{padding:""},{default:o(()=>[s(U,{class:"q-mb-md"},{separator:o(()=>[s(v,{size:"1.5em",name:"chevron_right"})]),default:o(()=>[s(y,{label:"Home",icon:"home",to:{name:"appDashboard"}}),s(y,{label:"SMS Log"})]),_:1}),A,s(R,null,{default:o(()=>[s(C,{rows:f.value,columns:B,"row-key":"id",filter:l.keyword,loading:u.value,pagination:a.value,"onUpdate:pagination":t[1]||(t[1]=e=>a.value=e),onRequest:_,class:"no-shadow","rows-per-page-options":g(E)},{"top-left":o(()=>[s(x,{modelValue:l.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>l.keyword=e),debounce:500,placeholder:"Keyword"},{append:o(()=>[s(v,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-created_at":o(e=>[s(P,{props:e},{default:o(()=>[M(c(g(K)(e.row.created_at)),1),H,p("small",$,c(g(O)(e.row.created_at)),1)]),_:2},1032,["props"])]),"body-cell-sending_user_id":o(e=>[s(P,{props:e},{default:o(()=>[e.row.sendingUser?(w(),T("span",j,c(e.row.sendingUser.fullname),1)):q("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1})]),_:1}))}});export{me as default};
