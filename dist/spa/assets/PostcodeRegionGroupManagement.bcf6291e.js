import{A as L,r as g,B as U,i as M,o as T,E as A,m as v,K as _,L as o,l as e,R as $,ai as G,G as Q,S as b,ag as J,M as X,N as x,U as y,y as h,ae as Y,Q as D,aj as Z,n as E,F as ne,t as se,q as N,O as F}from"./index.7da93179.js";import{a as re,Q as q}from"./QBreadcrumbs.96094532.js";import{Q as I}from"./QSpace.2d911a61.js";import{Q as ie}from"./QSelect.0342b451.js";import{Q as ue}from"./QHeader.9f36f572.js";import{Q as de,a as z}from"./QTable.01150601.js";import{a as H,Q as K}from"./QItem.642560fa.js";import{Q as me}from"./QList.709f4980.js";import{Q as pe}from"./QMenu.00781621.js";import{Q as ce}from"./QPage.e25f8b02.js";import{Q as ge,a as fe}from"./QLayout.bec178d3.js";import{C as k}from"./ClosePopup.42f5b568.js";import{a as P}from"./axios.07c7c7d9.js";import{Q as ee,a as oe}from"./QToolbarTitle.8a26e038.js";import{u as ae,r as S}from"./index.esm.0811bb15.js";import{u as V}from"./debug.9f3fb657.js";import{d as le,o as W,s as ve,r as be,a as we}from"./help.4068c5a1.js";import{_ as te}from"./PostcodeRegionMapField.33d88427.js";import{a as _e}from"./geolocation.17ee4622.js";import"./rtl.ba9e3bff.js";import"./format.3e32b8d9.js";import"./QResizeObserver.66f1c4a6.js";import"./QMarkupTable.f781861b.js";import"./QLinearProgress.6e390987.js";import"./use-fullscreen.62410448.js";import"./QBadge.d2d220ed.js";const Qe=L({__name:"PostcodeRegionGroupCreate",setup(O){const m=g(!1),i=U({name:null,postcoderegions:null}),a=g(!1),p=g(),u=M("bus"),s=ae({name:{required:S},postcoderegions:{required:S}},i),f=()=>{a.value=!0,P.post("/postcoderegiongroup",i).then(()=>{le("positive","Group created"),u.emit("postcodeRegionGroupLoadMore"),Object.assign(i,{id:null,name:null,icon:null,visible_booking:!1,visible_shop:!1}),m.value=!1,a.value=!1,sessionStorage.removeItem("postcodeRegionGroups")}).catch(c=>{a.value=!1,V(c)})};return T(async()=>{u.on("newPostcodeRegionGroup",async()=>{p.value=await _e(),Object.assign(i,{name:null,postcoderegions:null}),m.value=!0})}),A(()=>{u.off("newPostcodeRegionGroup")}),(c,l)=>(v(),_(Z,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=r=>m.value=r),persistent:""},{default:o(()=>[e(D,{class:"modal-lg"},{default:o(()=>[e(ee,null,{default:o(()=>[e(oe,null,{default:o(()=>[$("New "+G(c.$t("postcodeRegionGroup.name")),1)]),_:1}),e(I),Q(e(b,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1}),e(J),e(X,null,{default:o(()=>[e(x,{modelValue:i.name,"onUpdate:modelValue":l[0]||(l[0]=r=>i.name=r),label:"Name of the group",error:y(s).name.$invalid},null,8,["modelValue","error"]),p.value?(v(),_(te,{key:0,"lat-lng":p.value,modelValue:i.postcoderegions,"onUpdate:modelValue":l[1]||(l[1]=r=>i.postcoderegions=r),"show-map":!0},null,8,["lat-lng","modelValue"])):h("",!0)]),_:1}),e(Y,{align:"right"},{default:o(()=>[Q(e(b,{label:"Cancel",flat:"",color:"secondary"},null,512),[[k]]),e(b,{disable:a.value||y(s).$invalid,label:"Save",color:"primary",onClick:l[2]||(l[2]=r=>f()),loading:a.value},null,8,["disable","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),ke=L({__name:"PostcodeRegionGroupEdit",setup(O){const m=g(!1),i=g(),a=U({id:null,name:null,postcoderegions:null}),p=g(!1),u=M("bus"),s=ae({name:{required:S},postcoderegions:{required:S}},a),f=()=>{p.value=!0,P.put(`/postcoderegiongroup/${a.id}`,a).then(()=>{le("positive","Group updated"),u.emit("postcodeRegionGroupLoadMore"),m.value=!1,p.value=!1,localStorage.sessionStorage("postcodeRegionGroups")}).catch(c=>{p.value=!1,V(c)})};return T(()=>{u.on("editPostcodeRegionGroup",async c=>{P.get(`/postcoderegiongroup/${c}`).then(l=>{Object.assign(a,l.data),a.postcoderegions&&a.postcoderegions[0]&&(i.value={lat:parseFloat(a.postcoderegions[0].meta.pivot_lat),lng:parseFloat(a.postcoderegions[0].meta.pivot_lng)}),m.value=!0}).catch(l=>{V(l)})})}),A(()=>{u.off("postcodeRegionGroupLoadMore")}),(c,l)=>(v(),_(Z,{modelValue:m.value,"onUpdate:modelValue":l[3]||(l[3]=r=>m.value=r),persistent:""},{default:o(()=>[a.name?(v(),_(D,{key:0,class:"modal-lg"},{default:o(()=>[e(ee,null,{default:o(()=>[e(oe,null,{default:o(()=>[$(G(a.name),1)]),_:1}),e(I),Q(e(b,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1}),e(J),e(X,null,{default:o(()=>[e(x,{modelValue:a.name,"onUpdate:modelValue":l[0]||(l[0]=r=>a.name=r),label:"Name of the group",error:y(s).name.$invalid},null,8,["modelValue","error"]),i.value?(v(),_(te,{key:0,"lat-lng":i.value,modelValue:a.postcoderegions,"onUpdate:modelValue":l[1]||(l[1]=r=>a.postcoderegions=r),zoom:12,"show-map":!0},null,8,["lat-lng","modelValue"])):h("",!0)]),_:1}),e(Y,{align:"right"},{default:o(()=>[Q(e(b,{label:"Cancel",flat:"",color:"secondary"},null,512),[[k]]),e(b,{disable:p.value||y(s).$invalid,label:"Update",color:"primary",onClick:l[2]||(l[2]=r=>f())},null,8,["disable"])]),_:1})]),_:1})):h("",!0)]),_:1},8,["modelValue"]))}}),ye={class:"q-pl-md q-pt-sm q-pr-md q-pb-sm flex items-center",style:{"padding-top":"11px"}},Pe=["onClick"],Ve={key:0,class:"q-ml-sm"},Xe=L({__name:"PostcodeRegionGroupManagement",setup(O){const m=M("bus"),i=g(),a=g(null),p=g(!1),u=U({keyword:null,state:null}),B=[{name:"name",label:"Name",align:"left",field:"name",sortable:!0},{label:"Actions",name:"actions",sortable:!1,field:"actions"}],s=g({page:1,rowsNumber:W(),rowsPerPage:W(),sortBy:"name",descending:!1}),f=(d=null)=>{let n,t,w,R;d&&d.pagination?(n=d.pagination.page,t=d.pagination.rowsPerPage,w=d.pagination.sortBy,R=d.pagination.descending):(n=s.value.page,t=s.value.rowsPerPage,w=s.value.sortBy,R=s.value.descending),p.value=!0,P.post(`/postcoderegiongroup/datatable/${n}`,{sortBy:w,sort_order:R?"desc":"asc",skip:n,rowsPerPage:t,keyword:u.keyword,state:u.state}).then(C=>{var j;i.value=C.data.rows,p.value=!1,ve(t),s.value.rowsNumber=C.data.total,s.value.page=n,s.value.rowsPerPage=t,s.value.sortBy=w,s.value.descending=R,d&&((j=a.value)==null||j.scrollIntoView({behavior:"smooth",block:"center"}))}).catch(C=>{V(C)})},c=d=>{we("This will remove the postcode region group").onOk(()=>{P.delete(`/postcoderegiongroup/${d}`).then(()=>{f()}).catch(n=>{V(n)})})},l=()=>{m.emit("newPostcodeRegionGroup")},r=d=>{m.emit("editPostcodeRegionGroup",d)};return T(()=>{m.on("postcodeRegionGroupLoadMore",()=>{f()}),f()}),A(()=>{m.off("postcodeRegionGroupLoadMore")}),(d,n)=>(v(),E(ne,null,[e(Qe),e(ke),e(ge,{view:"lHh LpR fFf",container:"",class:"layout-height"},{default:o(()=>[e(ue,{class:se({"page-title text-black":!d.$q.dark.isActive,"bg-dark":d.$q.dark.isActive}),bordered:""},{default:o(()=>[N("div",ye,[e(re,null,{separator:o(()=>[e(F,{size:"1.5em",name:"chevron_right"})]),default:o(()=>[e(q,{label:"Home",icon:"home",to:{name:"appDashboard"}}),e(q,{label:"Settings",to:{name:"settings"}}),e(q,{label:d.$t("postcodeRegionGroup.namePlural")},null,8,["label"])]),_:1}),e(x,{modelValue:u.keyword,"onUpdate:modelValue":n[0]||(n[0]=t=>u.keyword=t),debounce:500,placeholder:"Keyword search",dense:"",borderless:"",class:"q-ml-lg",clearable:""},{prepend:o(()=>[e(F,{name:"search"})]),_:1},8,["modelValue"]),e(I),e(ie,{modelValue:u.state,"onUpdate:modelValue":[n[1]||(n[1]=t=>u.state=t),n[2]||(n[2]=t=>f(null))],debounce:500,label:"State",style:{"min-width":"100px"},clearable:"",dense:"",outlined:"",options:["ACT","NSW","NT","QLD","SA","TAS","VIC","WA"],class:"q-mr-sm"},null,8,["modelValue"]),e(b,{onClick:n[3]||(n[3]=t=>l()),icon:"add",color:"primary",round:""})])]),_:1},8,["class"]),e(fe,null,{default:o(()=>[e(ce,{padding:""},{default:o(()=>[e(D,null,{default:o(()=>[N("div",{ref_key:"topRef",ref:a},null,512),e(de,{rows:i.value,columns:B,"row-key":"id",filter:u.keyword,loading:p.value,pagination:s.value,"onUpdate:pagination":n[4]||(n[4]=t=>s.value=t),onRequest:f,flat:"","wrap-cells":"","rows-per-page-options":y(be)},{"body-cell-name":o(t=>[e(z,{props:t},{default:o(()=>[N("a",{onClick:w=>r(t.row.id),class:"link text-h6"},G(t.row.name),9,Pe),t.row.postcoderegions?(v(),E("span",Ve,G(t.row.postcoderegions.length)+" Suburbs ",1)):h("",!0)]),_:2},1032,["props"])]),"body-cell-actions":o(t=>[e(z,{props:t},{default:o(()=>[e(b,{flat:"",icon:"more_vert"},{default:o(()=>[e(pe,null,{default:o(()=>[e(me,null,{default:o(()=>[Q((v(),_(K,{clickable:"",onClick:w=>r(t.row.id)},{default:o(()=>[e(H,null,{default:o(()=>[$("Edit record")]),_:1})]),_:2},1032,["onClick"])),[[k]]),Q((v(),_(K,{clickable:"",onClick:w=>c(t.row.id)},{default:o(()=>[e(H,null,{default:o(()=>[$("Delete")]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1})]),_:1})]),_:1})]),_:1})],64))}});export{Xe as default};
