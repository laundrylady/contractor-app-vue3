import{A as P,r as g,B as W,o as F,J as L,m as d,K as b,L as e,l as t,O as N,M as c,q as a,S as f,Q as m,n as y,U as u,b8 as r,F as V,b7 as Y,y as B,R as x}from"./index.fbd59a76.js";import{Q as w,a as G}from"./QBreadcrumbs.18e816d5.js";import{Q as I}from"./QBtnGroup.bdc458fc.js";import{a as D,Q as _}from"./QItemSection.e2ef8c04.js";import{Q as M}from"./QList.eaa15994.js";import{Q as U}from"./QPage.c929a5d1.js";import{m as O,a as R}from"./axios.b71dd2ad.js";import{u as A}from"./use-quasar.1140b8ec.js";import{_ as T}from"./UserAvatar.a874c3dc.js";import{_ as $}from"./DateField.33bf04e7.js";import{u as S}from"./debug.805a8aef.js";import{a as p,C as H}from"./help.24013814.js";import{G as z}from"./index.a2595f93.js";import"./format.c926bd4b.js";import"./ClosePopup.117d0adb.js";const J=a("div",{class:"text-h6 q-mb-md"}," Commissions Overview",-1),K={class:"row q-col-gutter-md"},j={class:"col-xs-12 col-sm-5"},X={class:"col-xs-12 col-sm-5"},Z={class:"col-xs-12 col-sm-2"},tt={key:0},et={class:"row q-col-gutter-md"},at={class:"col-xs-12 col-sm-9"},ot={style:{"min-height":"200px"}},st={class:"row q-col-gutter-md q-mb-md"},lt={class:"col-xs-12 col-sm-6"},rt={class:"text-h5"},nt=a("div",null,"Paid in Period",-1),it={class:"col-xs-12 col-sm-6"},dt={class:"text-h5"},ct=a("div",null,"Earners",-1),mt={class:"col-xs-12 col-sm-3"},ut={class:"text-h5"},_t=a("div",null,"Total Commissions Paid",-1),ft={class:"text-h5"},pt=a("div",null,"Total Commissions Owing",-1),vt=a("div",{class:"text-h5 q-mb-md"},"Top Earners",-1),Rt=P({__name:"CommissionsOverview",setup(ht){const n=g(),k=g(),v=g(),E=g({title:"Commission Payment History",height:200,backgroundColor:{fill:"transparent"}}),C=A(),i=W({start:O().startOf("isoWeek").format("DD/MM/YYYY"),end:O().endOf("isoWeek").format("DD/MM/YYYY")}),h=l=>{const o=H(l);i.start=o.start,i.end=o.end},Q=()=>{C.loading.show({message:"Fetching commission data..."}),R.post("/user/contractor/reporting/commissionsoverview",i).then(l=>{n.value=l.data,v.value=[["Week","Amount"]];for(const o of l.data.dateRange.history)v.value.push([o.week,o.amount]);C.loading.hide()}).catch(l=>{S(l),C.loading.hide()})};return F(()=>{Q(),R.post("/user/contractor/reporting/commissionsowing").then(l=>{k.value=l.data}).catch(l=>{S(l)})}),(l,o)=>{const q=L("router-link");return d(),b(U,{padding:""},{default:e(()=>[t(G,{class:"q-mb-md q-mt-md"},{separator:e(()=>[t(N,{size:"1.5em",name:"chevron_right"})]),default:e(()=>[t(w,{label:"Home",icon:"home",to:{name:"appDashboard"}}),t(w,{label:"Reporting",to:{name:"reporting"}}),t(w,{label:"Commissions Overview"})]),_:1}),t(m,{class:"bg-seamless q-mb-lg"},{default:e(()=>[t(c,null,{default:e(()=>[J,a("div",K,[a("div",j,[t($,{modelValue:i.start,"onUpdate:modelValue":o[0]||(o[0]=s=>i.start=s),label:"Start",dense:!0,outlined:!0},null,8,["modelValue"]),t(I,{flat:"",class:"q-mt-xs"},{default:e(()=>[t(f,{flat:"",onClick:o[1]||(o[1]=s=>h("t")),label:"T",color:"primary",title:"Today"}),t(f,{flat:"",onClick:o[2]||(o[2]=s=>h("w")),label:"W",color:"primary",title:"Week"}),t(f,{flat:"",onClick:o[3]||(o[3]=s=>h("m")),label:"M",color:"primary",title:"Month"}),t(f,{flat:"",onClick:o[4]||(o[4]=s=>h("y")),label:"Y",color:"primary",title:"Year"})]),_:1})]),a("div",X,[t($,{modelValue:i.end,"onUpdate:modelValue":o[5]||(o[5]=s=>i.end=s),label:"End",dense:!0,outlined:!0},null,8,["modelValue"])]),a("div",Z,[t(f,{onClick:o[6]||(o[6]=s=>Q()),label:"Submit",color:"primary"})])])]),_:1})]),_:1}),n.value&&v.value?(d(),y("div",tt,[a("div",et,[a("div",at,[a("div",ot,[t(u(z),{type:"LineChart",data:v.value,options:E.value,class:"q-mb-md"},null,8,["data","options"])]),a("div",st,[a("div",lt,[t(m,{class:"bg-secondary text-white text-center"},{default:e(()=>[t(c,null,{default:e(()=>[a("div",rt,r(u(p)(n.value.dateRange.total)),1),nt]),_:1})]),_:1})]),a("div",it,[t(m,{class:"bg-secondary text-white text-center"},{default:e(()=>[t(c,null,{default:e(()=>[a("div",dt,r(n.value.dateRange.top.length),1),ct]),_:1})]),_:1})])]),t(M,{bordered:"",separator:""},{default:e(()=>[(d(!0),y(V,null,Y(n.value.dateRange.top,s=>(d(),b(D,{key:s.contractor.id},{default:e(()=>[t(_,{avatar:""},{default:e(()=>[t(T,{user:s.contractor},null,8,["user"])]),_:2},1024),t(_,null,{default:e(()=>[t(q,{to:{name:"contractor-dashboard",params:{id:s.contractor.id}},class:"link text-h6",target:"_blank"},{default:e(()=>[x(r(s.contractor.fullname),1)]),_:2},1032,["to"])]),_:2},1024),t(_,{side:"",class:"text-h6"},{default:e(()=>[x(r(u(p)(s.amount)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),a("div",mt,[t(m,{class:"bg-positive text-white q-mb-md"},{default:e(()=>[t(c,{class:"text-center"},{default:e(()=>[a("div",ut,r(u(p)(n.value.allTime.total)),1),_t]),_:1})]),_:1}),k.value?(d(),b(m,{key:0,class:"bg-negative text-white q-mb-md"},{default:e(()=>[t(c,{class:"text-center"},{default:e(()=>[a("div",ft,r(u(p)(k.value.total.total)),1),pt]),_:1})]),_:1})):B("",!0),t(m,{class:"bg-seamless"},{default:e(()=>[t(c,null,{default:e(()=>[vt,t(M,{separator:"",class:"bg-white"},{default:e(()=>[(d(!0),y(V,null,Y(n.value.allTime.top,s=>(d(),b(D,{key:s.contractor.id},{default:e(()=>[t(_,{avatar:""},{default:e(()=>[t(T,{user:s.contractor},null,8,["user"])]),_:2},1024),t(_,null,{default:e(()=>[t(q,{to:{name:"contractor-dashboard",params:{id:s.contractor.id}},class:"link",target:"_blank"},{default:e(()=>[x(r(s.contractor.fullname),1)]),_:2},1032,["to"])]),_:2},1024),t(_,{side:"",class:"text-h6"},{default:e(()=>[x(r(u(p)(s.amount)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])])])):B("",!0)]),_:1})}}});export{Rt as default};
