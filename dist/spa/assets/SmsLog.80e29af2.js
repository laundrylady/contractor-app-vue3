import{A as Q,r as m,B as x,o as N,m as w,K as S,L as o,l as s,O as v,U as g,N as V,R as M,b8 as c,q as p,n as T,y as q,Q as R}from"./index.fbd59a76.js";import{Q as y,a as U}from"./QBreadcrumbs.18e816d5.js";import{a as z,Q as P}from"./QTable.1191bda5.js";import{Q as C}from"./QPage.c929a5d1.js";import{a as D}from"./axios.b71dd2ad.js";import{u as I}from"./debug.805a8aef.js";import{x as h,z as L,y as E,l as K,f as O}from"./help.24013814.js";import"./QList.eaa15994.js";import"./QMarkupTable.e4b2956c.js";import"./QSelect.5b5bbc87.js";import"./QItemSection.e2ef8c04.js";import"./rtl.af167dee.js";import"./format.c926bd4b.js";import"./QLinearProgress.457e2dab.js";const A=p("div",{class:"text-h4 q-mb-md"}," SMS Log ",-1),H=p("br",null,null,-1),$={class:"text-grey"},j={key:0},ie=Q({__name:"SmsLog",setup(F){const f=m(),k=m(null),u=m(!1),l=x({keyword:null,type:"contractor",status:"active",role:"contractor"}),B=[{name:"created_at",label:"Sent",align:"left",field:"created_at",sortable:!0},{name:"sending_user_id",label:"Sent by",align:"left",field:"sending_user_id",sortable:!0},{name:"mobile",sortable:!0,label:"Mobile",field:"mobile",align:"left"},{name:"message",sortable:!0,label:"Message",field:"message",align:"left"},{name:"message_id",sortable:!0,label:"Message ID",field:"message_id",align:"left"}],a=m({page:1,rowsNumber:h(),rowsPerPage:h(),sortBy:"created_at",descending:!1}),_=(r=null)=>{let t,e,n,i;r&&r.pagination?(t=r.pagination.page,e=r.pagination.rowsPerPage,n=r.pagination.sortBy,i=r.pagination.descending):(t=a.value.page,e=a.value.rowsPerPage,n=a.value.sortBy,i=a.value.descending),u.value=!0,D.post(`/sms/datatable/${t}`,{sortBy:n,sort_order:i?"desc":"asc",skip:t,rowsPerPage:e,keyword:l.keyword}).then(d=>{var b;f.value=d.data.rows,u.value=!1,L(e),a.value.rowsNumber=d.data.total,a.value.page=t,a.value.rowsPerPage=e,a.value.sortBy=n,a.value.descending=i,r&&((b=k.value)==null||b.scrollIntoView({behavior:"smooth",block:"center"}))}).catch(d=>{I(d)})};return N(()=>{_()}),(r,t)=>(w(),S(C,{padding:""},{default:o(()=>[s(U,{class:"q-mb-md"},{separator:o(()=>[s(v,{size:"1.5em",name:"chevron_right"})]),default:o(()=>[s(y,{label:"Home",icon:"home",to:{name:"appDashboard"}}),s(y,{label:"SMS Log"})]),_:1}),A,s(R,null,{default:o(()=>[s(z,{rows:f.value,columns:B,"row-key":"id",filter:l.keyword,loading:u.value,pagination:a.value,"onUpdate:pagination":t[1]||(t[1]=e=>a.value=e),onRequest:_,class:"no-shadow","rows-per-page-options":g(E)},{"top-left":o(()=>[s(V,{modelValue:l.keyword,"onUpdate:modelValue":t[0]||(t[0]=e=>l.keyword=e),debounce:500,placeholder:"Keyword"},{append:o(()=>[s(v,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-created_at":o(e=>[s(P,{props:e},{default:o(()=>[M(c(g(K)(e.row.created_at)),1),H,p("small",$,c(g(O)(e.row.created_at)),1)]),_:2},1032,["props"])]),"body-cell-sending_user_id":o(e=>[s(P,{props:e},{default:o(()=>[e.row.sendingUser?(w(),T("span",j,c(e.row.sendingUser.fullname),1)):q("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1})]),_:1}))}});export{ie as default};
