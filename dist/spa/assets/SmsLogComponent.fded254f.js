import{A as N,i as h,r as c,B as x,o as Q,E as V,m as b,K as S,L as o,l,N as T,O as U,R as C,b8 as _,U as p,q as k,n as M,y as L,Q as R}from"./index.fbd59a76.js";import{Q as y,a as q}from"./QTable.1191bda5.js";import{a as z}from"./axios.b71dd2ad.js";import{u as D}from"./debug.805a8aef.js";import{x as v,l as I,f as E,y as K,z as O}from"./help.24013814.js";const j=k("br",null,null,-1),A={class:"text-grey"},$={key:0},X=N({__name:"SmsLogComponent",props:{team_id:null,bulk:{type:Boolean},order_id:null,user_id:null},setup(B){const r=B,f=h("bus"),w=c(),g=c(!1),n=x({keyword:null}),P=[{name:"created_at",label:"Sent",align:"left",field:"created_at",sortable:!0},{name:"sending_user_id",label:"Sent by",align:"left",field:"sending_user_id",sortable:!0},{name:"mobile",sortable:!0,label:"Mobile",field:"mobile",align:"left"},{name:"message",sortable:!0,label:"Message",field:"message",align:"left"},{name:"message_id",sortable:!0,label:"Message ID",field:"message_id",align:"left"}],a=c({page:1,rowsNumber:v(),rowsPerPage:v(),sortBy:"created_at",descending:!0}),m=(t=null)=>{let s,e,d,i;t&&t.pagination?(s=t.pagination.page,e=t.pagination.rowsPerPage,d=t.pagination.sortBy,i=t.pagination.descending):(s=a.value.page,e=a.value.rowsPerPage,d=a.value.sortBy,i=a.value.descending),g.value=!0,z.post(`/sms/datatable/${s}`,{sortBy:d,sort_order:i?"desc":"asc",skip:s,rowsPerPage:e,keyword:n.keyword,user_id:r.user_id,team_id:r.team_id,order_id:r.order_id,bulk:r.bulk}).then(u=>{w.value=u.data.rows,g.value=!1,O(e),a.value.rowsNumber=u.data.total,a.value.page=s,a.value.rowsPerPage=e,a.value.sortBy=d,a.value.descending=i}).catch(u=>{D(u)})};return Q(()=>{m(),f.on("getSmsLog",()=>{m()})}),V(()=>{f.off("getSmsLog")}),(t,s)=>(b(),S(R,null,{default:o(()=>[l(q,{rows:w.value,columns:P,"row-key":"id",filter:n.keyword,loading:g.value,pagination:a.value,"onUpdate:pagination":s[1]||(s[1]=e=>a.value=e),onRequest:m,class:"no-shadow","rows-per-page-options":p(K)},{"top-left":o(()=>[l(T,{modelValue:n.keyword,"onUpdate:modelValue":s[0]||(s[0]=e=>n.keyword=e),debounce:500,placeholder:"Keyword"},{append:o(()=>[l(U,{name:"search"})]),_:1},8,["modelValue"])]),"body-cell-created_at":o(e=>[l(y,{props:e},{default:o(()=>[C(_(p(I)(e.row.created_at)),1),j,k("small",A,_(p(E)(e.row.created_at)),1)]),_:2},1032,["props"])]),"body-cell-sending_user_id":o(e=>[l(y,{props:e},{default:o(()=>[e.row.sendingUser?(b(),M("span",$,_(e.row.sendingUser.fullname),1)):L("",!0)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1}))}});export{X as _};
