import{A as R,r as m,B as V,o as x,J as D,m as v,K as Q,L as a,l as e,q as k,O as y,N as I,S as h,t as L,Q as M,U as P,R as p,ai as B,G as $}from"./index.7da93179.js";import{a as A,Q as f}from"./QBreadcrumbs.96094532.js";import{Q as j}from"./QSpace.2d911a61.js";import{Q as z}from"./QHeader.9f36f572.js";import{Q as E,a as g}from"./QTable.01150601.js";import{Q as H,a as O}from"./QItem.642560fa.js";import{Q as U}from"./QList.709f4980.js";import{Q as K}from"./QMenu.00781621.js";import{Q as F}from"./QPage.e25f8b02.js";import{Q as G,a as J}from"./QLayout.bec178d3.js";import{C as W}from"./ClosePopup.42f5b568.js";import{a as C}from"./axios.07c7c7d9.js";import{u as N}from"./debug.9f3fb657.js";import{o as T,s as X,r as Y,l as Z,a as ee}from"./help.4068c5a1.js";import"./QResizeObserver.66f1c4a6.js";import"./QMarkupTable.f781861b.js";import"./QSelect.0342b451.js";import"./rtl.ba9e3bff.js";import"./format.3e32b8d9.js";import"./QLinearProgress.6e390987.js";import"./use-fullscreen.62410448.js";const ae={class:"q-pl-md q-pt-sm q-pr-md q-pb-sm flex items-center",style:{"padding-top":"11px"}},Pe=R({__name:"NotificationTemplateManagement",setup(te){const b=m(),w=m(null),u=m(!1),i=V({keyword:null}),q=[{name:"name",label:"Name",align:"left",field:"name",sortable:!0},{name:"subject",label:"Subject",align:"left",field:"subject",sortable:!0},{name:"updated_at",label:"Last updated",align:"left",field:"updated_at",sortable:!0},{label:"Actions",name:"actions",sortable:!1,field:"actions"}],r=m({page:1,rowsNumber:T(),rowsPerPage:T(),sortBy:"name",descending:!1}),c=(o=null)=>{let l,s,t,n;o&&o.pagination?(l=o.pagination.page,s=o.pagination.rowsPerPage,t=o.pagination.sortBy,n=o.pagination.descending):(l=r.value.page,s=r.value.rowsPerPage,t=r.value.sortBy,n=r.value.descending),u.value=!0,C.post(`/notificationtemplate/datatable/${l}`,{sortBy:t,sort_order:n?"desc":"asc",skip:l,rowsPerPage:s,keyword:i.keyword}).then(d=>{var _;b.value=d.data.rows,u.value=!1,X(s),r.value.rowsNumber=d.data.total,r.value.page=l,r.value.rowsPerPage=s,r.value.sortBy=t,r.value.descending=n,o&&((_=w.value)==null||_.scrollIntoView({behavior:"smooth",block:"center"}))}).catch(d=>{N(d)})},S=o=>{ee("This will remove the template").onOk(()=>{C.delete(`/notificationtemplate/${o}`).then(()=>{c()}).catch(l=>{N(l)})})};return x(()=>{c()}),(o,l)=>{const s=D("router-link");return v(),Q(G,{view:"lHh LpR fFf",container:"",class:"layout-height"},{default:a(()=>[e(z,{class:L({"page-title text-black":!o.$q.dark.isActive,"bg-dark":o.$q.dark.isActive}),bordered:""},{default:a(()=>[k("div",ae,[e(A,null,{separator:a(()=>[e(y,{size:"1.5em",name:"chevron_right"})]),default:a(()=>[e(f,{label:"Home",icon:"home",to:{name:"appDashboard"}}),e(f,{label:"Settings",to:{name:"settings"}}),e(f,{label:"Email Templates"})]),_:1}),e(I,{modelValue:i.keyword,"onUpdate:modelValue":l[0]||(l[0]=t=>i.keyword=t),debounce:500,placeholder:"Keyword search",dense:"",borderless:"",class:"q-ml-lg",clearable:""},{prepend:a(()=>[e(y,{name:"search"})]),_:1},8,["modelValue"]),e(j),e(h,{to:{name:"notificationTemplateCreate"},icon:"add",labe:"New SMS Template",color:"primary",round:""})])]),_:1},8,["class"]),e(J,null,{default:a(()=>[e(F,{padding:""},{default:a(()=>[e(M,null,{default:a(()=>[k("div",{ref_key:"topRef",ref:w},null,512),e(E,{rows:b.value,columns:q,"row-key":"id",filter:i.keyword,loading:u.value,pagination:r.value,"onUpdate:pagination":l[1]||(l[1]=t=>r.value=t),onRequest:c,class:"no-shadow","rows-per-page-options":P(Y)},{"body-cell-name":a(t=>[e(g,{props:t},{default:a(()=>[e(s,{to:{name:"notificationTemplateEdit",params:{id:t.row.id}},class:"link"},{default:a(()=>[p(B(t.row.name),1)]),_:2},1032,["to"])]),_:2},1032,["props"])]),"body-cell-updated_at":a(t=>[e(g,{props:t},{default:a(()=>[p(B(P(Z)(t.row.updated_at)),1)]),_:2},1032,["props"])]),"body-cell-actions":a(t=>[e(g,{props:t},{default:a(()=>[e(h,{flat:"",icon:"more_vert"},{default:a(()=>[e(K,null,{default:a(()=>[e(U,null,{default:a(()=>[$((v(),Q(H,{clickable:"",onClick:n=>S(t.row.id)},{default:a(()=>[e(O,null,{default:a(()=>[p("Delete")]),_:1})]),_:2},1032,["onClick"])),[[W]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1})]),_:1})]),_:1})]),_:1})}}});export{Pe as default};
