import{A as N,r as f,B as M,i as q,o as U,E as x,m as Q,K as T,L as a,Q as L,l as e,R as P,ai as ee,G as _,S as g,ag as H,N as y,U as v,M as z,ae as K,y as ae,aj as G,n as le,F as te,t as oe,q as E,O as I}from"./index.7da93179.js";import{a as ne,Q as B}from"./QBreadcrumbs.96094532.js";import{Q as D}from"./QSpace.2d911a61.js";import{Q as se}from"./QHeader.9f36f572.js";import{a as O,Q as j}from"./QItem.642560fa.js";import{Q as re}from"./QList.709f4980.js";import{Q as me}from"./QMenu.00781621.js";import{Q as ie,a as de}from"./QTable.01150601.js";import{Q as ue}from"./QPage.e25f8b02.js";import{Q as pe,a as ce}from"./QLayout.bec178d3.js";import{C as k}from"./ClosePopup.42f5b568.js";import{a as V}from"./axios.07c7c7d9.js";import{a as J,Q as W}from"./QToolbarTitle.8a26e038.js";import{u as X,r as h}from"./index.esm.0811bb15.js";import{u as S}from"./debug.9f3fb657.js";import{d as Y,o as F,s as fe,r as ge,a as ve}from"./help.4068c5a1.js";import"./QResizeObserver.66f1c4a6.js";import"./QMarkupTable.f781861b.js";import"./QSelect.0342b451.js";import"./rtl.ba9e3bff.js";import"./format.3e32b8d9.js";import"./QLinearProgress.6e390987.js";import"./use-fullscreen.62410448.js";const be=N({__name:"SmsTemplateEdit",setup(R){const s=f(!1),t=M({id:null,name:null,content:null}),c=f(!1),u=q("bus"),p=X({content:{required:h},name:{required:h}},t),o=()=>{V.put(`/smstemplate/${t.id}`,t).then(()=>{Y("positive","Template updated"),u.emit("smsTemplateLoadMore"),s.value=!1,c.value=!1}).catch(d=>{S(d)})};return U(()=>{u.on("editSmsTemplate",d=>{V.get(`/smstemplate/${d}`).then(l=>{Object.assign(t,l.data),s.value=!0}).catch(l=>{S(l)})})}),x(()=>{u.off("editSmsTemplate")}),(d,l)=>(Q(),T(G,{modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=n=>s.value=n)},{default:a(()=>[t.name?(Q(),T(L,{key:0,class:"modal"},{default:a(()=>[e(W,null,{default:a(()=>[e(J,null,{default:a(()=>[P(ee(t.name),1)]),_:1}),e(D),_(e(g,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1}),e(H),e(z,null,{default:a(()=>[e(y,{modelValue:t.name,"onUpdate:modelValue":l[0]||(l[0]=n=>t.name=n),label:"Name of the template",error:v(p).name.$invalid},null,8,["modelValue","error"]),e(y,{modelValue:t.content,"onUpdate:modelValue":l[1]||(l[1]=n=>t.content=n),label:"Content",error:v(p).content.$invalid,autogrow:""},null,8,["modelValue","error"])]),_:1}),e(K,{align:"right"},{default:a(()=>[_(e(g,{label:"Cancel",flat:"",color:"secondary"},null,512),[[k]]),e(g,{disable:c.value||v(p).$invalid,label:"Update",color:"primary",onClick:l[2]||(l[2]=n=>o())},null,8,["disable"])]),_:1})]),_:1})):ae("",!0)]),_:1},8,["modelValue"]))}}),we=N({__name:"SmsTemplateCreate",setup(R){const s=f(!1),t=M({id:null,name:null,content:null}),c=f(!1),u=q("bus"),p=X({content:{required:h},name:{required:h}},t),o=()=>{V.post("/smstemplate",t).then(()=>{Y("positive","Template created"),u.emit("smsTemplateLoadMore"),s.value=!1,c.value=!1}).catch(d=>{S(d)})};return U(()=>{u.on("newSmsTemplate",()=>{s.value=!0})}),x(()=>{u.off("newSmsTemplate")}),(d,l)=>(Q(),T(G,{modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=n=>s.value=n)},{default:a(()=>[e(L,{class:"modal"},{default:a(()=>[e(W,null,{default:a(()=>[e(J,null,{default:a(()=>[P("New SMS Template")]),_:1}),e(D),_(e(g,{icon:"close",flat:"",round:"",dense:""},null,512),[[k]])]),_:1}),e(H),e(z,null,{default:a(()=>[e(y,{modelValue:t.name,"onUpdate:modelValue":l[0]||(l[0]=n=>t.name=n),label:"Name of the template",error:v(p).name.$invalid},null,8,["modelValue","error"]),e(y,{modelValue:t.content,"onUpdate:modelValue":l[1]||(l[1]=n=>t.content=n),label:"Content",error:v(p).content.$invalid,autogrow:""},null,8,["modelValue","error"])]),_:1}),e(K,{align:"right"},{default:a(()=>[_(e(g,{label:"Cancel",flat:"",color:"secondary"},null,512),[[k]]),e(g,{disable:c.value||v(p).$invalid,label:"Save",color:"primary",onClick:l[2]||(l[2]=n=>o())},null,8,["disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),Qe={class:"q-pl-md q-pt-sm q-pr-md q-pb-sm flex items-center",style:{"padding-top":"11px"}},je=N({__name:"SmsTemplateManagement",setup(R){const s=q("bus"),t=f(),c=f(null),u=f(!1),b=M({keyword:null}),p=[{name:"name",label:"Name",align:"left",field:"name",sortable:!0},{name:"content",sortable:!0,label:"Content",field:"content",align:"left"},{label:"Actions",name:"actions",sortable:!1,field:"actions"}],o=f({page:1,rowsNumber:F(),rowsPerPage:F(),sortBy:"name",descending:!1}),d=(r=null)=>{let m,i,w,C;r&&r.pagination?(m=r.pagination.page,i=r.pagination.rowsPerPage,w=r.pagination.sortBy,C=r.pagination.descending):(m=o.value.page,i=o.value.rowsPerPage,w=o.value.sortBy,C=o.value.descending),u.value=!0,V.post(`/smstemplate/datatable/${m}`,{sortBy:w,sort_order:C?"desc":"asc",skip:m,rowsPerPage:i,keyword:b.keyword}).then($=>{var A;t.value=$.data.rows,u.value=!1,fe(i),o.value.rowsNumber=$.data.total,o.value.page=m,o.value.rowsPerPage=i,o.value.sortBy=w,o.value.descending=C,r&&((A=c.value)==null||A.scrollIntoView({behavior:"smooth",block:"center"}))}).catch($=>{S($)})},l=r=>{ve("This will remove the template").onOk(()=>{V.delete(`/smstemplate/${r}`).then(()=>{d()}).catch(m=>{S(m)})})},n=()=>{s.emit("newSmsTemplate")},Z=r=>{s.emit("editSmsTemplate",r)};return U(()=>{s.on("smsTemplateLoadMore",()=>{d()}),d()}),x(()=>{s.off("smsTemplateLoadMore")}),(r,m)=>(Q(),le(te,null,[e(be),e(we),e(pe,{view:"lHh LpR fFf",container:"",class:"layout-height"},{default:a(()=>[e(se,{class:oe({"page-title text-black":!r.$q.dark.isActive,"bg-dark":r.$q.dark.isActive}),bordered:""},{default:a(()=>[E("div",Qe,[e(ne,null,{separator:a(()=>[e(I,{size:"1.5em",name:"chevron_right"})]),default:a(()=>[e(B,{label:"Home",icon:"home",to:{name:"appDashboard"}}),e(B,{label:"Settings",to:{name:"settings"}}),e(B,{label:"SMS Templates"})]),_:1}),e(y,{modelValue:b.keyword,"onUpdate:modelValue":m[0]||(m[0]=i=>b.keyword=i),debounce:500,placeholder:"Keyword search",dense:"",borderless:"",class:"q-ml-lg",clearable:""},{prepend:a(()=>[e(I,{name:"search"})]),_:1},8,["modelValue"]),e(D),e(g,{onClick:m[1]||(m[1]=i=>n()),icon:"add",labe:"New SMS Template",color:"primary",round:""})])]),_:1},8,["class"]),e(ce,null,{default:a(()=>[e(ue,{padding:""},{default:a(()=>[e(L,null,{default:a(()=>[E("div",{ref_key:"topRef",ref:c},null,512),e(ie,{rows:t.value,columns:p,"row-key":"id",filter:b.keyword,loading:u.value,pagination:o.value,"onUpdate:pagination":m[2]||(m[2]=i=>o.value=i),onRequest:d,class:"no-shadow","rows-per-page-options":v(ge)},{"body-cell-actions":a(i=>[e(de,{props:i},{default:a(()=>[e(g,{flat:"",icon:"more_vert"},{default:a(()=>[e(me,null,{default:a(()=>[e(re,null,{default:a(()=>[_((Q(),T(j,{clickable:"",onClick:w=>Z(i.row.id)},{default:a(()=>[e(O,null,{default:a(()=>[P("Edit record")]),_:1})]),_:2},1032,["onClick"])),[[k]]),_((Q(),T(j,{clickable:"",onClick:w=>l(i.row.id)},{default:a(()=>[e(O,null,{default:a(()=>[P("Delete")]),_:1})]),_:2},1032,["onClick"])),[[k]])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),_:1},8,["rows","filter","loading","pagination","rows-per-page-options"])]),_:1})]),_:1})]),_:1})]),_:1})],64))}});export{je as default};
