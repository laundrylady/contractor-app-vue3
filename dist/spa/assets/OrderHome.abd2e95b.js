import{A,r as S,m as i,n as x,l as e,L as a,R as r,bp as w,S as C,ad as E,i as L,B as I,o as M,E as U,w as H,J as V,K as f,y as c,q as u,O as _,b8 as o,U as h,t as z}from"./index.fbd59a76.js";import{a as F,Q as B}from"./QBreadcrumbs.18e816d5.js";import{Q as P}from"./QBadge.3656646d.js";import{Q as j}from"./QHeader.de31cb0a.js";import{Q as D}from"./rtl.af167dee.js";import{a as n,Q as l}from"./QItemSection.e2ef8c04.js";import{Q as T}from"./QList.eaa15994.js";import{Q as G}from"./QDrawer.4f90ed80.js";import{Q as J}from"./QPage.c929a5d1.js";import{Q as K,a as W}from"./QLayout.8099c30b.js";import{a as O}from"./axios.b71dd2ad.js";import{Q as k,_ as X}from"./QRouteTab.508a79a0.js";import{_ as Y}from"./PostcodeRegionDisplay.44f67ec8.js";import{_ as Z}from"./StatusTag.5e471305.js";import{u as R}from"./debug.805a8aef.js";import{i as ee,j as N,l as ae}from"./help.24013814.js";import{Q as te}from"./format.c926bd4b.js";import{Q as le}from"./QTabs.0e213cdb.js";import"./QResizeObserver.6ff9e290.js";import"./TouchPan.3f62f8a1.js";import"./touch.70a9dd44.js";const oe=A({__name:"OrderNav",props:{model:null},setup(m){const v=S("dashboard");return($,p)=>(i(),x("div",null,[e(C,{color:"black",outline:"",icon:"menu",class:"lt-sm"},{default:a(()=>[e(te,{"auto-close":""},{default:a(()=>[e(T,{style:{"min-width":"100px"}},{default:a(()=>[e(n,{clickable:"",to:{name:"order-edit",params:{id:m.model.id}}},{default:a(()=>[e(l,null,{default:a(()=>[r("Details")]),_:1})]),_:1},8,["to"]),e(w),e(n,{clickable:"",to:{name:"order-documents",params:{id:m.model.id}}},{default:a(()=>[e(l,null,{default:a(()=>[r("Documents")]),_:1})]),_:1},8,["to"]),e(w),e(n,{clickable:"",to:{name:"order-sms",params:{id:m.model.id}}},{default:a(()=>[e(l,null,{default:a(()=>[r("SMS Notifications")]),_:1})]),_:1},8,["to"]),e(n,{clickable:"",to:{name:"order-notifications",params:{id:m.model.id}}},{default:a(()=>[e(l,null,{default:a(()=>[r("Email Notifications")]),_:1})]),_:1},8,["to"]),e(w),e(n,{clickable:"",to:{name:"order-audit",params:{id:m.model.id}}},{default:a(()=>[e(l,null,{default:a(()=>[r("Audit")]),_:1})]),_:1},8,["to"])]),_:1})]),_:1})]),_:1}),e(le,{modelValue:v.value,"onUpdate:modelValue":p[0]||(p[0]=Q=>v.value=Q),align:"left","active-bg-color":"primary","active-color":"white"},{default:a(()=>[e(k,{to:{name:"order-edit",params:{id:m.model.id}},label:"Details",icon:"info"},null,8,["to"]),e(k,{to:{name:"order-documents",params:{id:m.model.id}},label:"Documents",icon:"attach_file"},null,8,["to"]),e(k,{to:{name:"order-sms",params:{id:m.model.id}},label:"SMS",icon:"chat"},null,8,["to"]),e(k,{to:{name:"order-notifications",params:{id:m.model.id}},label:"Emails",icon:"mail"},null,8,["to"]),e(k,{to:{name:"order-audit",params:{id:m.model.id}},label:"Audit",icon:"bolt"},null,8,["to"])]),_:1},8,["modelValue"])]))}}),re={class:"q-pl-md q-pr-md q-pt-md"},de={class:"flex"},se={class:"q-mb-lg"},ue={class:"row items-center q-mb-lg"},ie={class:"col-xs-12 col-sm-9"},ne={class:"flex items-center"},me={class:"text-h4"},ce={class:"q-mr-sm"},_e={class:"q-mt-xs"},fe={key:0,class:"col-xs-2 col-sm-3 text-right"},pe=u("br",null,null,-1),ve={key:0,class:"text-right q-pa-sm"},ge=["href"],be=["href"],Me=A({__name:"OrderHome",setup(m){const v=E(),$=L("bus"),p=I({left:!0,right:!0}),Q=S(),t=S(),y=async(d={})=>{O.get(`/order/${v.params.id}`).then(s=>{var g;d.onlyTotals&&t.value?(t.value.total_price=s.data.total_price,t.value.total_price_gst=s.data.total_price_gst,t.value.grand_total_price=s.data.grand_total_price,s.data.products.length!==t.value.products.length&&(t.value.products=s.data.products)):t.value=s.data,document.title=`Booking #${s.data.display_id}`,(g=t.value)!=null&&g.recurring_order&&O.get(`/order/futurerecurring/${t.value.id}`).then(b=>{Q.value=b.data}).catch(b=>{R(b)})}).catch(s=>{R(s)})};return M(async()=>{await y(),$.on("getOrder",d=>{y(d)})}),U(()=>{$.off("getOrder")}),H(()=>v.params.id,d=>{d&&v.name==="order-edit"&&y()}),(d,s)=>{const g=V("router-link"),b=V("router-view");return t.value&&t.value.id?(i(),f(K,{key:0,view:"lHh Lpr lFf",container:"",class:"layout-height"},{default:a(()=>[e(j,{class:z({"page-title text-black":!d.$q.dark.isActive,"bg-dark":d.$q.dark.isActive}),bordered:""},{default:a(()=>[u("div",re,[u("div",de,[e(F,{class:"q-mb-md"},{separator:a(()=>[e(_,{size:"1.5em",name:"chevron_right"})]),default:a(()=>[e(B,{label:"Home",icon:"home",to:{name:"appDashboard"}}),e(B,{label:d.$t("order.namePlural"),to:{name:"orders"}},null,8,["label"]),e(B,{label:`#${t.value.display_id.toString()}`},null,8,["label"])]),_:1})]),u("div",se,[u("div",ue,[u("div",ie,[u("div",ne,[u("div",me,[d.$q.screen.lt.lg?(i(),f(C,{key:0,onClick:s[0]||(s[0]=q=>p.left=!p.left),icon:"menu",color:"primary",outline:"",class:"q-mr-md"})):c("",!0),u("span",ce,o(d.$t("order.name"))+" #"+o(t.value.display_id),1)]),e(Z,{status:t.value.status},null,8,["status"]),t.value.recurring_parent_id?(i(),f(g,{key:0,to:{name:"order-edit",params:{id:t.value.recurring_parent_id}},class:"link q-ml-sm",target:"_blank"},{default:a(()=>[r("Recurring")]),_:1},8,["to"])):c("",!0),t.value.recurring_order?(i(),f(P,{key:1,class:"q-ml-sm q-pa-sm"},{default:a(()=>[e(_,{name:"sync",class:"q-mr-xs"}),r(o(`Every
                                  ${t.value.recurring} on ${h(ee)(t.value.scheduled_pickup_date)} ${t.value.agreed_pickup_time?t.value.agreed_pickup_time:h(N)(t.value.scheduled_pickup_time)}`),1)]),_:1})):c("",!0)]),u("div",_e,[r(o(t.value.team.name)+" ",1),e(_,{name:"event"}),r(" "+o(t.value.scheduled_pickup_date)+" ("+o(h(N)(t.value.scheduled_pickup_time))+")",1)])]),d.$q.screen.xs?c("",!0):(i(),x("div",fe,[u("div",null,[r(" Last updated"),pe,u("strong",null,o(h(ae)(t.value.updated_at)),1)])]))]),e(oe,{model:t.value},null,8,["model"])])])]),_:1},8,["class"]),e(G,{modelValue:p.left,"onUpdate:modelValue":s[2]||(s[2]=q=>p.left=q),width:300,side:"left",bordered:""},{default:a(()=>[d.$q.screen.xs?(i(),x("div",ve,[e(C,{onClick:s[1]||(s[1]=q=>p.left=!1),icon:"close",flat:"",round:"",dense:""})])):c("",!0),t.value.lat&&t.value.lng?(i(),f(X,{key:1,"lat-lng":{lat:parseFloat(t.value.lat),lng:parseFloat(t.value.lng)}},null,8,["lat-lng"])):c("",!0),e(T,{dense:"",class:"q-mt-md q-ml-sm q-mr-sm"},{default:a(()=>[e(D,{header:""},{default:a(()=>[r(o(d.$t("team.name")),1)]),_:1}),e(n,null,{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"account_circle"})]),_:1}),e(l,null,{default:a(()=>[e(g,{to:{name:"team-dashboard",params:{id:t.value.team_id}},class:"link"},{default:a(()=>[r(o(t.value.team.name),1)]),_:1},8,["to"])]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"phone"})]),_:1}),e(l,null,{default:a(()=>[u("a",{href:`tel:${t.value.team.mobile}`,class:"link"},o(t.value.team.mobile),9,ge)]),_:1})]),_:1}),e(D,{header:""},{default:a(()=>[r(o(d.$t("team.pickupAddress")),1)]),_:1}),e(n,null,{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"place"})]),_:1}),e(l,null,{default:a(()=>[u("div",null,o(t.value.address1)+" "+o(t.value.address2),1),t.value.suburbpostcoderegion?(i(),f(Y,{key:0,postcoderegions:[t.value.suburbpostcoderegion]},null,8,["postcoderegions"])):c("",!0)]),_:1})]),_:1}),e(n,null,{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"event"})]),_:1}),e(l,null,{default:a(()=>[r(o(t.value.scheduled_pickup_date)+" ("+o(h(N)(t.value.scheduled_pickup_time))+") ",1)]),_:1})]),_:1}),e(D,{header:""},{default:a(()=>[r(o(d.$t("contractor.name")),1)]),_:1}),t.value.contractor?(i(),f(n,{key:0},{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"engineering"})]),_:1}),e(l,null,{default:a(()=>[e(g,{to:{name:"contractor-dashboard",params:{id:t.value.contractor.id}},class:"link"},{default:a(()=>[r(o(t.value.contractor.contractor_badge_name),1)]),_:1},8,["to"])]),_:1})]),_:1})):c("",!0),t.value.contractor?(i(),f(n,{key:1},{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"phone"})]),_:1}),e(l,null,{default:a(()=>[u("a",{href:`tel:${t.value.contractor.mobile}`,class:"link"},o(t.value.contractor.mobile),9,be)]),_:1})]),_:1})):c("",!0),t.value.contractor?c("",!0):(i(),f(n,{key:2},{default:a(()=>[e(l,{side:""},{default:a(()=>[e(_,{name:"warning",color:"negative"})]),_:1}),e(l,{class:"text-negative"},{default:a(()=>[r("NO CONTRACTOR ASSIGNED")]),_:1})]),_:1}))]),_:1})]),_:1},8,["modelValue"]),e(W,null,{default:a(()=>[e(J,{padding:""},{default:a(()=>[e(b,{model:t.value,"onUpdate:order":y,futureRecurring:Q.value},null,8,["model","futureRecurring"])]),_:1})]),_:1})]),_:1})):c("",!0)}}});export{Me as default};
