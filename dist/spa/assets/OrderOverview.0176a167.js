import{A as Y,r as b,B as $,o as B,m as _,K as y,L as a,l as e,O as M,M as i,q as t,ai as r,S as u,Q as c,n as R,U as m,F as O,b1 as F,R as f,y as S}from"./index.7da93179.js";import{Q as g,a as T}from"./QBreadcrumbs.96094532.js";import{Q as W}from"./QBtnGroup.17d5a1bd.js";import{Q as I,a as q}from"./QItem.642560fa.js";import{Q as L}from"./QList.709f4980.js";import{Q}from"./QCircularProgress.a2ed8130.js";import{Q as N}from"./QPage.e25f8b02.js";import{m as w,a as z}from"./axios.07c7c7d9.js";import{u as A}from"./use-quasar.41dfdbfa.js";import{_ as C}from"./DateField.87b7069c.js";import{u as E}from"./debug.9f3fb657.js";import{c as x,D as G,q as D}from"./help.4068c5a1.js";import{G as U}from"./index.7c46800b.js";import{u as H}from"./vue-i18n.runtime.esm-bundler.dc0339a7.js";import"./format.3e32b8d9.js";import"./ClosePopup.42f5b568.js";import"./QMenu.00781621.js";const K={class:"text-h6 q-mb-md"},j={class:"row q-col-gutter-md"},J={class:"col-xs-12 col-sm-5"},X={class:"col-xs-12 col-sm-5"},Z={class:"col-xs-12 col-sm-2"},ee={key:0},te={class:"row q-col-gutter-md"},ae={class:"col-xs-12 col-sm-9"},oe={style:{"min-height":"200px"}},se={class:"row q-col-gutter-md q-mb-md"},le={class:"col-xs-12 col-sm-6"},re={class:"text-h5"},de=t("div",null,"Revenue in Period",-1),ne={class:"col-xs-12 col-sm-6"},ie={class:"text-h5"},ce=t("div",null,"Orders",-1),me={class:"text-h6"},ue={class:"col-xs-12 col-sm-3"},ve={class:"text-h5"},pe=t("div",null,"All Time Revenue",-1),_e={class:"text-center q-pt-md"},fe={class:"q-pa-sm text-caption"},he={class:"text-center q-pt-md"},be={class:"q-pa-sm text-caption"},Se=Y({__name:"OrderOverview",setup(ge){const s=b(),v=b(),P=H(),V=b({title:`${P.t("order.namePlural")} History`,height:200,backgroundColor:{fill:"transparent"}}),h=A(),n=$({start:w().startOf("isoWeek").format("DD/MM/YYYY"),end:w().endOf("isoWeek").format("DD/MM/YYYY")}),p=d=>{const o=G(d);n.start=o.start,n.end=o.end},k=()=>{h.loading.show({message:"Fetching order data..."}),z.post("/order/reporting/overview",n).then(d=>{s.value=d.data,v.value=[["Week","Amount"]];for(const o of d.data.dateRange.history)v.value.push([o.week,o.total]);s.value.dateRange.history=s.value.dateRange.history.reverse(),h.loading.hide()}).catch(d=>{E(d),h.loading.hide()})};return B(()=>{k()}),(d,o)=>(_(),y(N,{padding:""},{default:a(()=>[e(T,{class:"q-mb-md q-mt-md"},{separator:a(()=>[e(M,{size:"1.5em",name:"chevron_right"})]),default:a(()=>[e(g,{label:"Home",icon:"home",to:{name:"appDashboard"}}),e(g,{label:"Reporting",to:{name:"reporting"}}),e(g,{label:d.$t("order.namePlural")},null,8,["label"])]),_:1}),e(c,{class:"bg-seamless q-mb-lg"},{default:a(()=>[e(i,null,{default:a(()=>[t("div",K,r(d.$t("order.namePlural"))+" Overview",1),t("div",j,[t("div",J,[e(C,{modelValue:n.start,"onUpdate:modelValue":o[0]||(o[0]=l=>n.start=l),label:"Start",dense:!0,outlined:!0},null,8,["modelValue"]),e(W,{flat:"",class:"q-mt-xs"},{default:a(()=>[e(u,{flat:"",onClick:o[1]||(o[1]=l=>p("t")),label:"T",color:"primary",title:"Today"}),e(u,{flat:"",onClick:o[2]||(o[2]=l=>p("w")),label:"W",color:"primary",title:"Week"}),e(u,{flat:"",onClick:o[3]||(o[3]=l=>p("m")),label:"M",color:"primary",title:"Month"}),e(u,{flat:"",onClick:o[4]||(o[4]=l=>p("y")),label:"Y",color:"primary",title:"Year"})]),_:1})]),t("div",X,[e(C,{modelValue:n.end,"onUpdate:modelValue":o[5]||(o[5]=l=>n.end=l),label:"End",dense:!0,outlined:!0},null,8,["modelValue"])]),t("div",Z,[e(u,{onClick:o[6]||(o[6]=l=>k()),label:"Submit",color:"primary"})])])]),_:1})]),_:1}),s.value&&v.value?(_(),R("div",ee,[t("div",te,[t("div",ae,[t("div",oe,[e(m(U),{type:"LineChart",data:v.value,options:V.value,class:"q-mb-md"},null,8,["data","options"])]),t("div",se,[t("div",le,[e(c,{class:"bg-secondary text-white text-center"},{default:a(()=>[e(i,null,{default:a(()=>[t("div",re,r(m(x)(s.value.dateRange.total)),1),de]),_:1})]),_:1})]),t("div",ne,[e(c,{class:"bg-secondary text-white text-center"},{default:a(()=>[e(i,null,{default:a(()=>[t("div",ie,r(s.value.dateRange.count),1),ce]),_:1})]),_:1})])]),e(L,{bordered:"",separator:""},{default:a(()=>[(_(!0),R(O,null,F(s.value.dateRange.history,l=>(_(),y(I,{key:l.week},{default:a(()=>[e(q,null,{default:a(()=>[t("div",null,[t("div",me,r(l.week),1),f(" "+r(m(D)(l.start))+" -> "+r(m(D)(l.end)),1)])]),_:2},1024),e(q,{side:"",class:"text-h6"},{default:a(()=>[f(r(m(x)(l.total)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),t("div",ue,[e(c,{class:"bg-positive text-white q-mb-md"},{default:a(()=>[e(i,{class:"text-center"},{default:a(()=>[t("div",ve,r(m(x)(s.value.allTime.total)),1),pe]),_:1})]),_:1}),e(c,{class:"bg-seamless q-mb-md"},{default:a(()=>[t("div",_e,[e(Q,{value:parseFloat(s.value.retainedRebooked.retainedPercentage),color:"primary",size:"64px","track-color":"grey-4","show-value":"",title:s.value.retainedRebooked.retained},{default:a(()=>[t("div",fe,r(s.value.retainedRebooked.retainedPercentage)+"%",1)]),_:1},8,["value","title"])]),e(i,{class:"text-center"},{default:a(()=>[f(" Retained ")]),_:1})]),_:1}),e(c,{class:"bg-seamless q-mb-md"},{default:a(()=>[t("div",he,[e(Q,{value:parseFloat(s.value.retainedRebooked.rebookedPercentage),color:"primary",size:"64px","track-color":"grey-4","show-value":"",title:s.value.retainedRebooked.rebooked},{default:a(()=>[t("div",be,r(s.value.retainedRebooked.rebookedPercentage)+"%",1)]),_:1},8,["value","title"])]),e(i,{class:"text-center"},{default:a(()=>[f(" Rebooked ")]),_:1})]),_:1})])])])):S("",!0)]),_:1}))}});export{Se as default};
